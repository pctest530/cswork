<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>公文範本文字複製工具</title>

    <style>
        body {
            font-family: "Microsoft JhengHei", sans-serif;
            margin: 30px;
            background: #f4f4f4;
        }
        h2 {
            margin-bottom: 10px;
        }
        .menu {
            margin-bottom: 15px;
        }
        select {
            padding: 8px;
            font-size: 16px;
        }
        textarea {
            width: 100%;
            height: 320px;
            padding: 15px;
            font-size: 16px;
            line-height: 1.6;
            box-sizing: border-box;
            border: 1px solid #999;
            border-radius: 8px;
            background: #fff;
            resize: vertical;
        }
        button {
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            border: none;
            background-color: #0078ff;
            color: white;
            cursor: pointer;
            border-radius: 6px;
        }
        button:hover {
            background-color: #005fcc;
        }

        /* 隱藏子分類 */
        #subCategoryBox.hidden {
            display: none;
        }
    </style>
</head>

<body>

<h2>公文範本系統</h2>

<div class="menu">
    <label>主分類：</label>
    <select id="mainCategory" onchange="updateSubCategory()">
        <option value="反光鏡">反光鏡</option>
        <option value="水溝蓋路面">水溝蓋路面</option>
        <option value="道路挖掘">道路挖掘</option>
        <option value="計畫">計畫</option>
    </select>

    <span id="subCategoryBox">
        <label style="margin-left:20px;">子分類：</label>
        <select id="subCategory" onchange="updateText()">
            <option value="村辦">村辦</option>
            <option value="廠商">廠商</option>
        </select>
    </span>
</div>

<textarea id="textArea"></textarea>
<button onclick="copyText()">COPY 複製內容</button>

<script>
const data = {

    "反光鏡": {
        "村辦": `主旨：有關貴村辦公處反映00路路牌 /反光鏡 倒塌修復一案，本所後續將依「114年度口湖鄉境內反光鏡及安全導標等設施維護修復工程(開口契約)」派工修復，請查照。

說明：復貴村辦公處110年0月00日口湖鄉下崙村辦字第11000號函。`,

        "廠商": `主旨:有關雲林縣口湖鄉下崙村南五路（路標:23.612116，120.153151）路牌損壞一案，惠請貴公司後續將依「114年度口湖鄉境內反光鏡及安全導標等設施維護修復工程(開口契約)案件編號:XX」派工修復，請查照。

正本:鎮磊實業有限公司    彰化縣田尾鄉豊田村光復路4段95之1號1樓`
    },

    "水溝蓋路面": {
        "村辦": `主旨：有關貴村辦公處反映福安路1處水溝蓋損壞改善一案，本所後續將依「口湖鄉114年度境內道路及水溝蓋等公有設施維護修復工程(開口合約)」派工修復。

說明：復貴村辦公處110年0月0日口鄉村辦字第114000號函。`,

        "廠商": `主旨：檢送「口湖鄉114年度境內道路及水溝蓋等公有設施維護修復工程(預估)」派工單（案件編號：00）1份，請查照。

說明:依據本鄉XX村辦公處11X年XX月XX日口鄉XX村辦字第11400XX號函辦理。`
    },

    "道路挖掘": {
        "完工": `主旨：有關貴營運所申報道路挖掘完工結案（案件編號：1140700000）一案，經本所於線上審核後，尚符合規定，爰本所同意貴營運所之申報案並接管，請查照。

說明：復貴營運所114年12月0日台水五北港室字第1144400000號函。

正本：台灣自來水股份有限公司第五區管理處北港營運所`,

        "付費": `主旨：有關自來水用水設備新(改)裝工程用戶「XXX」雲林縣口湖鄉XXX地號道路挖掘申請一案，復如說明，請查照。

說明：

一、復貴營運所114年10月00日台水五北港室字第1144400000號函。

二、經審視上傳於雲林縣道路挖掘系統（以下稱挖掘系統）之資料，本所原則同意申請。依據雲林縣道路挖掘許可修復費用收費標準第五條第二項第一款規定，本次道路挖掘許可費共計新臺幣100元整，請收到繳款書後儘速至農會完成繳費，並上傳於挖掘系統，俾本所核發路證事宜。

三、施工期間應做好安全防護措施，於完工後，請依「雲林縣道路挖掘施工管理及安全規範」、「雲林縣市區道路管理規則」辦理修復及標線復舊，並確保與相鄰路面平順銜接，以保障用路人安全。

四、另請依據雲林縣道路挖掘管理自治條例第13條規定之意旨，應於許可期限內施工及修復路面。並於許可施工期限屆滿後三十日內，將竣工圖工圖檔及相關證明文件利用公共管線道路資訊系統以公文通知向本所申請結案，俾後續通知貴營運所訂期辦理會勘或以書面方式進行查驗作業。

五、隨函檢附繳款書1份。

正本：台灣自來水股份有限公司第五區管理處北港營運所`
    },

    "計畫": {
        "內容": `檢陳「雲林縣政府114年度對鄉鎮市公所及機關學校補助工程申請表（計畫名稱：口湖鄉改善工程）」1份，所需經費共計新臺幣XXX萬元整，懇請鈞府擇期現勘並同意補助經費改善，以造福桑梓，請鑒核。`
    }
};

function updateSubCategory() {
    const main = document.getElementById("mainCategory").value;
    const subSelect = document.getElementById("subCategory");
    const subBox = document.getElementById("subCategoryBox");

    if (main === "道路挖掘") {
        subBox.classList.remove("hidden");
        subSelect.innerHTML = `
            <option value="完工">完工</option>
            <option value="付費">付費</option>
        `;
    } else if (main === "計畫") {
        subBox.classList.add("hidden");
    } else {
        subBox.classList.remove("hidden");
        subSelect.innerHTML = `
            <option value="村辦">村辦</option>
            <option value="廠商">廠商</option>
        `;
    }

    updateText();
}

function updateText() {
    const main = document.getElementById("mainCategory").value;

    if (main === "計畫") {
        document.getElementById("textArea").value = data["計畫"]["內容"];
        return;
    }

    const sub = document.getElementById("subCategory").value;
    document.getElementById("textArea").value = data[main][sub];
}

function copyText() {
    let text = document.getElementById("textArea");
    text.select();
    text.setSelectionRange(0, 99999);
    navigator.clipboard.writeText(text.value);
    alert("已複製！");
}

window.onload = updateText;
</script>

</body>
</html>
